<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SHAP value based Feature Importance plot — plot_feature_importance • treeshap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- dalexverse -->
<link href="../dalexverse.css" rel="stylesheet">
<link href="../dalexverse-2.css" rel="stylesheet">

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>






<meta property="og:title" content="SHAP value based Feature Importance plot — plot_feature_importance" />
<meta property="og:description" content="This function plots feature importance calculated as means of absolute values of SHAP values of variables (average impact on model output magnitude)." />

<meta name="robots" content="noindex" />


<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14""></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">treeshap</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.0.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/treeshap/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SHAP value based Feature Importance plot</h1>
    <small class="dont-index">Source: <a href='https://github.com/ModelOriented/treeshap/blob/master/R/plot.R'><code>R/plot.R</code></a></small>
    <div class="hidden name"><code>plot_feature_importance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function plots feature importance calculated as means of absolute values of SHAP values of variables (average impact on model output magnitude).</p>
    </div>

    <pre class="usage"><span class='fu'>plot_feature_importance</span><span class='op'>(</span>
  <span class='va'>shaps</span>,
  desc_sorting <span class='op'>=</span> <span class='cn'>TRUE</span>,
  max_vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>shaps</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='st'>"Feature Importance"</span>,
  subtitle <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>shaps</th>
      <td><p>SHAP values dataframe produced with the <code>treeshap</code> function.</p></td>
    </tr>
    <tr>
      <th>desc_sorting</th>
      <td><p>logical. Should the bars be sorted descending? By default TRUE.</p></td>
    </tr>
    <tr>
      <th>max_vars</th>
      <td><p>maximum number of variables that shall be presented. By default all are presented.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>the plot's title, by default <code>'Feature Importance'</code>.</p></td>
    </tr>
    <tr>
      <th>subtitle</th>
      <td><p>the plot's subtitle. By default no subtitle.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>ggplot2</code> object</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='treeshap.html'>treeshap</a></code> for calculation of SHAP values</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/dmlc/xgboost'>xgboost</a></span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>fifa20</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>fifa20</span><span class='op'>$</span><span class='va'>data</span><span class='op'>)</span> <span class='op'>!=</span> <span class='st'>'work_rate'</span><span class='op'>]</span>
<span class='va'>target</span> <span class='op'>&lt;-</span> <span class='va'>fifa20</span><span class='op'>$</span><span class='va'>target</span>
<span class='va'>param</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>objective <span class='op'>=</span> <span class='st'>"reg:squarederror"</span>, max_depth <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>xgb_model</span> <span class='op'>&lt;-</span> <span class='fu'>xgboost</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xgboost/man/xgb.train.html'>xgboost</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>, params <span class='op'>=</span> <span class='va'>param</span>, label <span class='op'>=</span> <span class='va'>target</span>, nrounds <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]	train-rmse:4486581.000000 
#&gt; [2]	train-rmse:3361763.250000 
#&gt; [3]	train-rmse:2565844.250000 
#&gt; [4]	train-rmse:2022569.875000 
#&gt; [5]	train-rmse:1619285.875000 
#&gt; [6]	train-rmse:1357081.875000 
#&gt; [7]	train-rmse:1170674.625000 
#&gt; [8]	train-rmse:1039663.937500 
#&gt; [9]	train-rmse:932790.312500 
#&gt; [10]	train-rmse:860090.625000 
#&gt; [11]	train-rmse:804609.625000 
#&gt; [12]	train-rmse:767626.812500 
#&gt; [13]	train-rmse:740147.812500 
#&gt; [14]	train-rmse:719762.812500 
#&gt; [15]	train-rmse:706933.812500 
#&gt; [16]	train-rmse:693178.625000 
#&gt; [17]	train-rmse:679898.187500 
#&gt; [18]	train-rmse:674524.875000 
#&gt; [19]	train-rmse:665713.437500 
#&gt; [20]	train-rmse:652927.562500 
#&gt; [21]	train-rmse:639453.000000 
#&gt; [22]	train-rmse:631931.875000 
#&gt; [23]	train-rmse:628959.312500 
#&gt; [24]	train-rmse:622040.187500 
#&gt; [25]	train-rmse:615448.562500 
#&gt; [26]	train-rmse:613797.937500 
#&gt; [27]	train-rmse:605600.562500 
#&gt; [28]	train-rmse:603055.250000 
#&gt; [29]	train-rmse:596921.687500 
#&gt; [30]	train-rmse:595214.062500 
#&gt; [31]	train-rmse:594137.875000 
#&gt; [32]	train-rmse:592722.750000 
#&gt; [33]	train-rmse:587882.000000 
#&gt; [34]	train-rmse:584771.500000 
#&gt; [35]	train-rmse:578607.125000 
#&gt; [36]	train-rmse:577946.750000 
#&gt; [37]	train-rmse:575824.250000 
#&gt; [38]	train-rmse:573312.750000 
#&gt; [39]	train-rmse:568914.562500 
#&gt; [40]	train-rmse:564939.500000 
#&gt; [41]	train-rmse:559615.812500 
#&gt; [42]	train-rmse:555904.937500 
#&gt; [43]	train-rmse:553897.562500 
#&gt; [44]	train-rmse:552377.812500 
#&gt; [45]	train-rmse:551200.812500 
#&gt; [46]	train-rmse:543481.187500 
#&gt; [47]	train-rmse:542949.812500 
#&gt; [48]	train-rmse:541332.062500 
#&gt; [49]	train-rmse:538625.125000 
#&gt; [50]	train-rmse:532953.812500 
#&gt; [51]	train-rmse:531559.625000 
#&gt; [52]	train-rmse:530476.812500 
#&gt; [53]	train-rmse:528406.062500 
#&gt; [54]	train-rmse:521505.218750 
#&gt; [55]	train-rmse:520598.687500 
#&gt; [56]	train-rmse:516478.875000 
#&gt; [57]	train-rmse:515682.031250 
#&gt; [58]	train-rmse:514609.000000 
#&gt; [59]	train-rmse:512419.906250 
#&gt; [60]	train-rmse:510127.781250 
#&gt; [61]	train-rmse:504156.250000 
#&gt; [62]	train-rmse:501481.812500 
#&gt; [63]	train-rmse:499434.312500 
#&gt; [64]	train-rmse:496394.031250 
#&gt; [65]	train-rmse:495844.781250 
#&gt; [66]	train-rmse:494176.375000 
#&gt; [67]	train-rmse:492409.531250 
#&gt; [68]	train-rmse:489478.843750 
#&gt; [69]	train-rmse:487688.187500 
#&gt; [70]	train-rmse:486379.781250 
#&gt; [71]	train-rmse:485383.125000 
#&gt; [72]	train-rmse:483979.718750 
#&gt; [73]	train-rmse:481904.312500 
#&gt; [74]	train-rmse:480251.093750 
#&gt; [75]	train-rmse:478812.593750 
#&gt; [76]	train-rmse:477639.562500 
#&gt; [77]	train-rmse:476773.718750 
#&gt; [78]	train-rmse:474864.750000 
#&gt; [79]	train-rmse:473888.250000 
#&gt; [80]	train-rmse:471276.656250 
#&gt; [81]	train-rmse:469682.312500 
#&gt; [82]	train-rmse:468950.281250 
#&gt; [83]	train-rmse:468394.031250 
#&gt; [84]	train-rmse:467058.343750 
#&gt; [85]	train-rmse:465381.312500 
#&gt; [86]	train-rmse:463539.406250 
#&gt; [87]	train-rmse:462440.656250 
#&gt; [88]	train-rmse:461192.937500 
#&gt; [89]	train-rmse:460384.562500 
#&gt; [90]	train-rmse:458866.000000 
#&gt; [91]	train-rmse:456654.468750 
#&gt; [92]	train-rmse:455613.968750 
#&gt; [93]	train-rmse:455122.937500 
#&gt; [94]	train-rmse:453131.906250 
#&gt; [95]	train-rmse:451065.750000 
#&gt; [96]	train-rmse:450597.968750 
#&gt; [97]	train-rmse:449825.531250 
#&gt; [98]	train-rmse:449018.906250 
#&gt; [99]	train-rmse:447143.937500 
#&gt; [100]	train-rmse:444112.531250 
#&gt; [101]	train-rmse:441351.468750 
#&gt; [102]	train-rmse:440108.000000 
#&gt; [103]	train-rmse:438838.656250 
#&gt; [104]	train-rmse:437694.312500 
#&gt; [105]	train-rmse:437166.000000 
#&gt; [106]	train-rmse:436571.062500 
#&gt; [107]	train-rmse:436040.500000 
#&gt; [108]	train-rmse:433524.031250 
#&gt; [109]	train-rmse:432169.500000 
#&gt; [110]	train-rmse:429161.281250 
#&gt; [111]	train-rmse:427771.656250 
#&gt; [112]	train-rmse:426731.281250 
#&gt; [113]	train-rmse:425817.437500 
#&gt; [114]	train-rmse:424805.718750 
#&gt; [115]	train-rmse:423696.718750 
#&gt; [116]	train-rmse:422583.187500 
#&gt; [117]	train-rmse:421460.187500 
#&gt; [118]	train-rmse:421063.437500 
#&gt; [119]	train-rmse:417863.718750 
#&gt; [120]	train-rmse:417616.375000 
#&gt; [121]	train-rmse:417145.218750 
#&gt; [122]	train-rmse:416822.812500 
#&gt; [123]	train-rmse:416027.218750 
#&gt; [124]	train-rmse:415133.468750 
#&gt; [125]	train-rmse:414246.593750 
#&gt; [126]	train-rmse:411989.687500 
#&gt; [127]	train-rmse:410993.593750 
#&gt; [128]	train-rmse:410076.531250 
#&gt; [129]	train-rmse:408748.281250 
#&gt; [130]	train-rmse:407586.687500 
#&gt; [131]	train-rmse:406917.531250 
#&gt; [132]	train-rmse:406422.218750 
#&gt; [133]	train-rmse:405127.718750 
#&gt; [134]	train-rmse:403180.062500 
#&gt; [135]	train-rmse:402424.031250 
#&gt; [136]	train-rmse:401981.343750 
#&gt; [137]	train-rmse:400429.468750 
#&gt; [138]	train-rmse:399471.656250 
#&gt; [139]	train-rmse:398170.687500 
#&gt; [140]	train-rmse:396799.343750 
#&gt; [141]	train-rmse:394820.062500 
#&gt; [142]	train-rmse:393622.031250 
#&gt; [143]	train-rmse:393429.875000 
#&gt; [144]	train-rmse:392676.875000 
#&gt; [145]	train-rmse:392112.000000 
#&gt; [146]	train-rmse:391111.500000 
#&gt; [147]	train-rmse:389163.781250 
#&gt; [148]	train-rmse:388552.281250 
#&gt; [149]	train-rmse:387892.250000 
#&gt; [150]	train-rmse:386419.750000 
#&gt; [151]	train-rmse:385907.187500 
#&gt; [152]	train-rmse:383801.937500 
#&gt; [153]	train-rmse:383378.937500 
#&gt; [154]	train-rmse:382820.937500 
#&gt; [155]	train-rmse:382133.093750 
#&gt; [156]	train-rmse:380109.406250 
#&gt; [157]	train-rmse:378921.968750 
#&gt; [158]	train-rmse:377941.093750 
#&gt; [159]	train-rmse:377350.781250 
#&gt; [160]	train-rmse:376439.875000 
#&gt; [161]	train-rmse:375588.718750 
#&gt; [162]	train-rmse:374107.531250 
#&gt; [163]	train-rmse:373750.031250 
#&gt; [164]	train-rmse:373187.437500 
#&gt; [165]	train-rmse:372845.906250 
#&gt; [166]	train-rmse:372117.187500 
#&gt; [167]	train-rmse:371603.343750 
#&gt; [168]	train-rmse:370779.500000 
#&gt; [169]	train-rmse:369511.343750 
#&gt; [170]	train-rmse:368900.656250 
#&gt; [171]	train-rmse:368450.187500 
#&gt; [172]	train-rmse:367442.625000 
#&gt; [173]	train-rmse:366723.875000 
#&gt; [174]	train-rmse:366248.031250 
#&gt; [175]	train-rmse:365661.375000 
#&gt; [176]	train-rmse:364705.468750 
#&gt; [177]	train-rmse:364192.187500 
#&gt; [178]	train-rmse:363884.250000 
#&gt; [179]	train-rmse:363003.906250 
#&gt; [180]	train-rmse:362021.406250 
#&gt; [181]	train-rmse:361301.093750 
#&gt; [182]	train-rmse:360885.218750 
#&gt; [183]	train-rmse:360510.718750 
#&gt; [184]	train-rmse:359024.343750 
#&gt; [185]	train-rmse:358766.781250 
#&gt; [186]	train-rmse:358507.031250 
#&gt; [187]	train-rmse:357207.093750 
#&gt; [188]	train-rmse:356523.718750 
#&gt; [189]	train-rmse:355505.343750 
#&gt; [190]	train-rmse:353378.562500 
#&gt; [191]	train-rmse:352559.281250 
#&gt; [192]	train-rmse:351736.781250 
#&gt; [193]	train-rmse:349713.500000 
#&gt; [194]	train-rmse:349121.843750 
#&gt; [195]	train-rmse:348947.812500 
#&gt; [196]	train-rmse:348441.281250 
#&gt; [197]	train-rmse:347524.187500 
#&gt; [198]	train-rmse:346942.875000 
#&gt; [199]	train-rmse:346422.718750 
#&gt; [200]	train-rmse:346166.062500 </div><div class='input'><span class='va'>unified_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='xgboost.unify.html'>xgboost.unify</a></span><span class='op'>(</span><span class='va'>xgb_model</span><span class='op'>)</span>
<span class='va'>shaps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='treeshap.html'>treeshap</a></span><span class='op'>(</span><span class='va'>unified_model</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in .Call("_treeshap_treeshap_cpp", PACKAGE = "treeshap", x_size,     fulfills, roots, yes, no, missing, feature, is_leaf, value,     cover): "_treeshap_treeshap_cpp" not available for .Call() for package "treeshap"</span></div><div class='input'><span class='fu'>plot_feature_importance</span><span class='op'>(</span><span class='va'>shaps</span>, max_vars <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in ncol(shaps): object 'shaps' not found</span></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Konrad Komisarczyk, Pawel Kozminski, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


